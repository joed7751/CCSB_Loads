library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
wwTHg_North <- importRDB("CombSpillWay_wwTHg.txt")
wwTHg_North
### Reading in Flow Data
NorthQ <- importRDB("SouthQDaily_2013_2019.txt")
NorthQ$Dates <- with(NorthQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
wwTHg_CombSpillWay <- importRDB("CombSpillWay_wwTHg.txt")
wwTHg_CombSpillWay
### Reading in Flow Data
CombSpillWayQ <- importRDB("SouthQDaily_2013_2019.txt")
CombSpillWayQ$Dates <- with(CombSpillWayQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
CombSpillWayQ
app1.lr <- selBestModel("wwTHg", data = wwTHg_CombSpillWay,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at CombSpillWay")
print(app1.lr)
wwTHg_CombSpillWay_lr1 <- loadReg(wwTHg ~ model(1), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr1
wwTHg_CombSpillWay_lr2 <- loadReg(wwTHg ~ model(2), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr2
wwTHg_CombSpillWay_lr3 <- loadReg(wwTHg ~ model(3), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr3
wwTHg_CombSpillWay_lr4 <- loadReg(wwTHg ~ model(4), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr4
wwTHg_CombSpillWay_lr5 <- loadReg(wwTHg ~ model(5), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr5
wwTHg_CombSpillWay_lr6 <- loadReg(wwTHg ~ model(6), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr6
wwTHg_CombSpillWay_lr7 <- loadReg(wwTHg ~ model(7), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr7
wwTHg_CombSpillWay_lr8 <- loadReg(wwTHg ~ model(8), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr8
wwTHg_CombSpillWay_lr9 <- loadReg(wwTHg ~ model(9), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr9
wwTHg_CombSpillWay_lr1
wwTHg_CombSpillWay_lr2
wwTHg_CombSpillWay_lr3
wwTHg_CombSpillWay_lr4
wwTHg_CombSpillWay_lr5
wwTHg_CombSpillWay_lr6
wwTHg_CombSpillWay_lr7
wwTHg_CombSpillWay_lr9
wwTHg_CombSpillWay_lr1 <- loadReg(wwTHg ~ model(1), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at CombSpillWay")
setSweave("wwTHg_CombSpillWay_lr1_plot2",5,5)
plot(wwTHg_CombSpillWay_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("wwTHg_CombSpillWay_lr1_plot1",5,5)
plot(wwTHg_CombSpillWay_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("wwTHg_CombSpillWay_lr1_plot3",5,5)
plot(wwTHg_CombSpillWay_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("wwTHg_CombSpillWay_lr1_plot4",5,5)
plot(wwTHg_CombSpillWay_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("wwTHg_CombSpillWay_lr1_plot5",5,5)
plot(wwTHg_CombSpillWay_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(wwTHg_CombSpillWay_lr1, CombSpillWayQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "CombSpillWay_wwTHg_conc_lr1_2013-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(wwTHg_CombSpillWay_lr1,CombSpillWayQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "CombSpillWay_wwTHgFlux_lr1_Day2013-2019.cvs")
preds_Flux_lr1WY<-predLoad(wwTHg_CombSpillWay_lr1,CombSpillWayQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "CombSpillWay_wwTHg_Flux_lr1_WY2013-2019.cvs")
wwTHg_CombSpillWay_lr1
library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at CombSpillWay
##############################################################################################
# Interpolation data:CombSpillWay wwTHg data grab sample observations
wwTHg_CombSpillWay <- importRDB("SN_wwTHg.txt")
wwTHg_CombSpillWay
### Reading in Flow Data
CombSpillWayQ <- importRDB("SouthQDaily_2013_2019.txt")
CombSpillWayQ$Dates <- with(CombSpillWayQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
CombSpillWayQ
app1.lr <- selBestModel("wwTHg", data = wwTHg_CombSpillWay,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at CombSpillWay")
print(app1.lr)
wwTHg_CombSpillWay <- importRDB("SN_wwTHg.txt")
app1.lr <- selBestModel("wwTHg", data = wwTHg_CombSpillWay,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at CombSpillWay")
print(app1.lr)
wwTHg_CombSpillWay_lr1 <- loadReg(wwTHg ~ model(1), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr1
wwTHg_CombSpillWay_lr1 <- loadReg(wwTHg ~ model(2), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr1
wwTHg_CombSpillWay_lr3 <- loadReg(wwTHg ~ model(3), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr3
wwTHg_CombSpillWay_lr4 <- loadReg(wwTHg ~ model(4), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr4
wwTHg_CombSpillWay_lr5 <- loadReg(wwTHg ~ model(5), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr5
wwTHg_CombSpillWay_lr6 <- loadReg(wwTHg ~ model(6), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr6
wwTHg_CombSpillWay_lr7 <- loadReg(wwTHg ~ model(7), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr7
wwTHg_CombSpillWay_lr8 <- loadReg(wwTHg ~ model(8), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr8
wwTHg_CombSpillWay_lr9 <- loadReg(wwTHg ~ model(9), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr9
wwTHg_CombSpillWay_lr2 <- loadReg(wwTHg ~ model(2), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr2
wwTHg_CombSpillWay_lr1 <- loadReg(wwTHg ~ model(1), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr1
wwTHg_CombSpillWay_lr2
wwTHg_CombSpillWay_lr3
wwTHg_CombSpillWay_lr4 <- loadReg(wwTHg ~ model(4), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at CombSpillWay")
wwTHg_CombSpillWay_lr3
wwTHg_CombSpillWay_lr4
wwTHg_CombSpillWay_lr5
wwTHg_CombSpillWay_lr7
wwTHg_CombSpillWay_lr8
wwTHg_CombSpillWay_lr9
wwTHg_CombSpillWay_lr2
wwTHg_CombSpillWay_lr5
wwTHg_CombSpillWay_lr5 <- loadReg(wwTHg ~ model(5), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at CombSpillWay")
setSweave("wwTHg_CombSpillWay_lr5_plot2",5,5)
plot(wwTHg_CombSpillWay_lr5,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("wwTHg_CombSpillWay_lr5_plot1",5,5)
plot(wwTHg_CombSpillWay_lr5,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("wwTHg_CombSpillWay_lr5_plot3",5,5)
plot(wwTHg_CombSpillWay_lr5,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("wwTHg_CombSpillWay_lr5_plot4",5,5)
plot(wwTHg_CombSpillWay_lr5,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("wwTHg_CombSpillWay_lr5_plot5",5,5)
plot(wwTHg_CombSpillWay_lr5,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr5 <- predConc(wwTHg_CombSpillWay_lr5, CombSpillWayQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr5
exportCSV(preds_conc_lr5, file.name = "CombSpillWay_wwTHg_conc_lr5_2013-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr5day<-predLoad(wwTHg_CombSpillWay_lr5,CombSpillWayQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr5day
exportCSV(preds_Flux_lr5day, file.name = "CombSpillWay_wwTHgFlux_lr5_Day2013-2019.cvs")
preds_Flux_lr5WY<-predLoad(wwTHg_CombSpillWay_lr5,CombSpillWayQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr5WY
exportCSV(preds_Flux_lr5WY, file.name = "CombSpillWay_wwTHg_Flux_lr5_WY2013-2019.cvs")
wwTHg_CombSpillWay_lr2 <- loadReg(wwTHg ~ model(2), data=wwTHg_CombSpillWay,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at CombSpillWay")
setSweave("wwTHg_CombSpillWay_lr2_plot2",5,5)
plot(wwTHg_CombSpillWay_lr2,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("wwTHg_CombSpillWay_lr2_plot1",5,5)
plot(wwTHg_CombSpillWay_lr2,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("wwTHg_CombSpillWay_lr2_plot3",5,5)
plot(wwTHg_CombSpillWay_lr2,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("wwTHg_CombSpillWay_lr2_plot4",5,5)
plot(wwTHg_CombSpillWay_lr2,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("wwTHg_CombSpillWay_lr2_plot5",5,5)
plot(wwTHg_CombSpillWay_lr2,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr2 <- predConc(wwTHg_CombSpillWay_lr2, CombSpillWayQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr2
exportCSV(preds_conc_lr2, file.name = "CombSpillWay_wwTHg_conc_lr2_2013-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr2day<-predLoad(wwTHg_CombSpillWay_lr2,CombSpillWayQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr2day
exportCSV(preds_Flux_lr2day, file.name = "CombSpillWay_wwTHgFlux_lr2_Day2013-2019.cvs")
preds_Flux_lr2WY<-predLoad(wwTHg_CombSpillWay_lr2,CombSpillWayQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr2WY
exportCSV(preds_Flux_lr2WY, file.name = "CombSpillWay_wwTHg_Flux_lr2_WY2013-2019.cvs")
View(preds_Flux_lr5WY)
