station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
View(pTHg_Road102_lr4)
View(Road102Q)
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
### Reading in Flow Data
Road102Q <- importRDB("Road102_DailyQ.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
pTHg_Road102 <- importRDB("Road102_pTHg_2010-2015.txt")
pTHg_Road102
### Reading in Flow Data
Road102Q <- importRDB("YoloQDaily_2010_2015.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
app1.lr <- selBestModel("pTHg", data = pTHg_Road102,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at Road102")
print(app1.lr)
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr1
pTHg_Road102_lr2 <- loadReg(pTHg ~ model(2), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr2
pTHg_Road102_lr3 <- loadReg(pTHg ~ model(3), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr3
pTHg_Road102_lr4 <- loadReg(pTHg ~ model(4), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr4
pTHg_Road102_lr5 <- loadReg(pTHg ~ model(5), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr5
pTHg_Road102_lr6 <- loadReg(pTHg ~ model(6), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr6
pTHg_Road102_lr7 <- loadReg(pTHg ~ model(7), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr7
pTHg_Road102_lr8 <- loadReg(pTHg ~ model(8), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr8
pTHg_Road102_lr9 <- loadReg(pTHg ~ model(9), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr9
pTHg_Road102_lr1
pTHg_Road102_lr3
### Reading in Flow Data
Road102Q <- importRDB("YoloQDaily_2010_2015.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
pTHg_Road102 <- importRDB("Road102_pTHg_2010-2015.txt")
pTHg_Road102
View(pTHg_Road102)
### Reading in Flow Data
Road102Q <- importRDB("YoloQDaily_2010_2015.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
View(Road102Q)
app1.lr <- selBestModel("pTHg", data = pTHg_Road102,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at Road102")
print(app1.lr)
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr1
pTHg_Road102_lr2 <- loadReg(pTHg ~ model(2), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr2
pTHg_Road102_lr3 <- loadReg(pTHg ~ model(3), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr3
pTHg_Road102_lr4 <- loadReg(pTHg ~ model(4), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr4
pTHg_Road102_lr5 <- loadReg(pTHg ~ model(5), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr5
pTHg_Road102_lr6 <- loadReg(pTHg ~ model(6), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr6
pTHg_Road102_lr7 <- loadReg(pTHg ~ model(7), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr7
pTHg_Road102_lr8 <- loadReg(pTHg ~ model(8), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr8
pTHg_Road102_lr9 <- loadReg(pTHg ~ model(9), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr9
pTHg_Road102_lr3 <- loadReg(pTHg ~ model(3), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr3_plot2",5,5)
plot(pTHg_Road102_lr3,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr3_plot1",5,5)
plot(pTHg_Road102_lr3,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr3_plot3",5,5)
plot(pTHg_Road102_lr3,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr3_plot4",5,5)
plot(pTHg_Road102_lr3,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr3_plot5",5,5)
plot(pTHg_Road102_lr3,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr3 <- predConc(pTHg_Road102_lr3, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr3
exportCSV(preds_conc_lr3, file.name = "Road102_pTHg_conc_lr3_2010-2015.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr3day<-predLoad(pTHg_Road102_lr3,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr3day
exportCSV(preds_Flux_lr3day, file.name = "pTHgFlux_lr3_Day2010-2015.cvs")
preds_Flux_lr3WY<-predLoad(pTHg_Road102_lr3,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr3WY
exportCSV(preds_Flux_lr3WY, file.name = "pTHg_Flux_lr3_WY2010-2015.cvs")
View(pTHg_Road102)
library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at Road102
##############################################################################################
# Interpolation data:Road102 pTHg data grab sample observations
pTHg_Road102 <- importRDB("Road102_pTHg.txt")
pTHg_Road102
### Reading in Flow Data
Road102Q <- importRDB("Road102_DailyQ.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
View(Road102Q)
app1.lr <- selBestModel("pTHg", data = pTHg_Road102,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at Road102")
print(app1.lr)
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr1
pTHg_Road102_lr2 <- loadReg(pTHg ~ model(2), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr2
pTHg_Road102_lr3 <- loadReg(pTHg ~ model(3), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr3
pTHg_Road102_lr4 <- loadReg(pTHg ~ model(4), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr4
pTHg_Road102_lr5 <- loadReg(pTHg ~ model(5), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr5
pTHg_Road102_lr6 <- loadReg(pTHg ~ model(6), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr6
pTHg_Road102_lr7 <- loadReg(pTHg ~ model(7), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr7
pTHg_Road102_lr8 <- loadReg(pTHg ~ model(8), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr8
pTHg_Road102_lr9 <- loadReg(pTHg ~ model(9), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Road102")
pTHg_Road102_lr9
###############################################################################################
###############################################################################################
#Once we decide on the model we want to use we can run some diagnostic plots
#In order to look at some diagnostic plots that are only availble in  we need to run the model we
#selected (we feel best fitted) outside of the loadflex routine (by rinignloadReg only)
#the most usful plots are plot 1, plot 2, and plot 5
###############################################################################################
###############################################################################################
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
View(preds_Flux_lr1WY)
library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at Road102
##############################################################################################
# Interpolation data:Road102 pTHg data grab sample observations
pTHg_Road102 <- importRDB("Road102_pTHg.txt")
pTHg_Road102
### Reading in Flow Data
Road102Q <- importRDB("Road102_DailyQ.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
pTHg_Road102 <- importRDB("Road102_pTHg.txt")
pTHg_Road102
### Reading in Flow Data
Road102Q <- importRDB("Road102_DailyQ.txt")
Road102Q$Dates <- with(Road102Q, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
Road102Q
View(Road102Q)
pTHg_Road102_lr1 <- loadReg(pTHg ~ model(1), data=pTHg_Road102,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Road102")
setSweave("pTHg_Road102_lr1_plot2",5,5)
plot(pTHg_Road102_lr1,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pTHg_Road102_lr1_plot1",5,5)
plot(pTHg_Road102_lr1,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pTHg_Road102_lr1_plot3",5,5)
plot(pTHg_Road102_lr1,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pTHg_Road102_lr1_plot4",5,5)
plot(pTHg_Road102_lr1,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pTHg_Road102_lr1_plot5",5,5)
plot(pTHg_Road102_lr1,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr1 <- predConc(pTHg_Road102_lr1, Road102Q, by= "day", allow.incomplete= TRUE )
preds_conc_lr1
exportCSV(preds_conc_lr1, file.name = "Road102_pTHg_conc_lr1_2010-2017.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr1day<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1day
exportCSV(preds_Flux_lr1day, file.name = "pTHgFlux_lr1_Day2010-2017.cvs")
preds_Flux_lr1WY<-predLoad(pTHg_Road102_lr1,Road102Q,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr1WY
exportCSV(preds_Flux_lr1WY, file.name = "pTHg_Flux_lr1_WY2010-2017.cvs")
