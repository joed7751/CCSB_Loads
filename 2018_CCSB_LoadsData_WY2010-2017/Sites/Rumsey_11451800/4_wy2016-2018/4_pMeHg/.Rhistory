library(akima)
library(dataRetrieval)
library(digest)
library(leaps)
library(lubridate)
library(memoise)
library(rloadest)
library(smwrBase)
library(smwrData)
library(smwrGraphs)
library(smwrQW)
library(smwrStats)
library(boot)
library(KernSmooth)
library(lattice)
pMeHg_Rumsey<-importRDB("pMeHg_RumseyR.txt")
RumseyQ<-importRDB("RumseyQR.txt")
View(pMeHg_Rumsey)
pMeHg_Rumseym1 <- loadReg(pMeHg ~model(1), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym1
pMeHg_Rumseym2 <- loadReg(pMeHg ~model(2), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym2
pMeHg_Rumseym3 <- loadReg(pMeHg ~model(3), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym3
pMeHg_Rumseym4 <- loadReg(pMeHg ~model(4), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym4
pMeHg_Rumseym5 <- loadReg(pMeHg ~model(5), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym5
pMeHg_Rumseym6 <- loadReg(pMeHg ~model(6), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym6
pMeHg_Rumseym7 <- loadReg(pMeHg ~model(7), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym7
pMeHg_Rumseym8 <- loadReg(pMeHg ~model(8), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym8
pMeHg_Rumseym9 <- loadReg(pMeHg ~model(9), data = pMeHg_Rumsey, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym9
View(pMeHg_Rumsey)
?loadReg
View(pMeHg_Rumsey)
?as.lcens
class(pMeHg_Rumsey$RpMeHg)
test<-as.lcens(pMeHg_Rumsey$PpMeHg,array(.1,dim(pMeHg_Rumsey)[2]),pMeHg_Rumsey$RpMeHg)
array(.1,dim(pMeHg_Rumsey)[2])
array(.1,dim(pMeHg_Rumsey)[1])
test<-as.lcens(pMeHg_Rumsey$PpMeHg,array(.1,dim(pMeHg_Rumsey)[1]),pMeHg_Rumsey$RpMeHg)
det<-array(.1,dim(pMeHg_Rumsey)[1])
test<-as.lcens(pMeHg_Rumsey$PpMeHg,det,pMeHg_Rumsey$RpMeHg)
class(pMeHg_Rumsey$PpMeHg)
class(det)
det<-as.numeric(det)
test<-as.lcens(pMeHg_Rumsey$PpMeHg,det,pMeHg_Rumsey$RpMeHg)
class(pMeHg_Rumsey)
test_frame<-data.frame(pMeHg_Rumsey[,1:3],test)
View(test_frame)
pMeHg_Rumseym1 <- loadReg(pMeHg ~model(1), data = test_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym1
View(test_frame)
pMeHg_Rumseym1 <- loadReg(test ~model(1), data = test_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym1
dim(test_frame)
dim(test_frame)[1]
dim(test_frame)[2]
library(akima)
library(dataRetrieval)
library(digest)
library(leaps)
library(lubridate)
library(memoise)
library(rloadest)
library(smwrBase)
library(smwrData)
library(smwrGraphs)
library(smwrQW)
library(smwrStats)
library(boot)
library(KernSmooth)
library(lattice)
pMeHg_Rumsey<-importRDB("pMeHg_RumseyR.txt")
RumseyQ<-importRDB("RumseyQR.txt")
View(pMeHg_Rumsey)
det<-as.numeric(array(.1,dim(pMeHg_Rumsey)[1]))
cen_data<-as.lcens(pMeHg_Rumsey$PpMeHg,det,pMeHg_Rumsey$RpMeHg)
cen_frame<-data.frame(pMeHg_Rumsey[,1:3],cen_data)
View(cen_frame)
pMeHg_Rumseym1 <- loadReg(cen_data ~model(1), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym1
pMeHg_Rumseym2 <- loadReg(cen_data ~model(2), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym2
pMeHg_Rumseym3 <- loadReg(cen_data ~model(3), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym3
pMeHg_Rumseym4 <- loadReg(cen_data ~model(4), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym4
pMeHg_Rumseym5 <- loadReg(cen_data ~model(5), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym5
pMeHg_Rumseym6 <- loadReg(cen_data ~model(6), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym6
pMeHg_Rumseym7 <- loadReg(cen_data ~model(7), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym7
pMeHg_Rumseym8 <- loadReg(cen_data ~model(8), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym8
pMeHg_Rumseym9 <- loadReg(cen_data ~model(9), data = cen_frame, flow="Flow", dates = "Dates" ,conc.units="ng/L" , station = "CCSB-Rumsey")
pMeHg_Rumseym9
plot(pMeHg_Rumseym1,ann=FALSE)
title(main = "4_11451800_pMeHg_m1 Response vs Fitted Values",xlab = "Fitted Values",ylab = "Response Values")
plot(pMeHg_Rumseym1,which = 2,set.up = F)
title(main = "4_11451800_pMeHg_m1 Residuals vs Fitted Values")
plot(pMeHg_Rumseym1,which = 3,set.up = F)
title(main = "4_11451800_pMeHg_m1 Assessing Heteroscedasticity")
plot(pMeHg_Rumseym1,which = 4,set.up = F)
title(main = "4_11451800_pMeHg_m1 Correlogram of Samples")
plot(pMeHg_Rumseym1,which = 5,set.up = F)
title(main="4_11451800_pMeHg_m1 Normal Discharge")
plot(pMeHg_Rumseym1,which = 6,set.up = F)
title(main="4_11451800_pMeHg_m1 Box Plot of Loads")
pMeHg_Rumsey_load<-predLoad(pMeHg_Rumseym1,RumseyQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
write.csv(pMeHg_Rumsey_load,"4_Rumsey_pMeHg_m1_Flux_Annual.csv")
pMeHg_Rumsey_load_day<-predLoad(pMeHg_Rumseym1, RumseyQ,load.units = "kg",by="day",allow.incomplete = TRUE,conf.int = 0.90,print = TRUE)
write.csv(pMeHg_Rumsey_load_day,"4_Rumsey_pMeHg_m1_Flux_Daily.csv")
