library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at South
##############################################################################################
# Interpolation data:South fMeHg data grab sample observations
fMeHg_South <- importRDB("South_fMeHg_2010-2019.txt")
fMeHg_South
### Reading in Flow Data
SouthQ <- importRDB("SouthQDaily_2010_2019.txt")
SouthQ$Dates <- with(SouthQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
SouthQ
View(fMeHg_South)
View(SouthQ)
fMeHg_South <- importRDB("South_fMeHg_2010-2019.txt")
View(fMeHg_South)
app1.lr <- selBestModel("fMeHg", data = fMeHg_South,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at South")
print(app1.lr)
library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at South
##############################################################################################
# Interpolation data:South fMeHg data grab sample observations
fMeHg_South <- importRDB("South_fMeHg_2010-2019.txt")
fMeHg_South
### Reading in Flow Data
SouthQ <- importRDB("SouthQDaily_2010_2019.txt")
SouthQ$Dates <- with(SouthQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
SouthQ
##############################################################################################
#Runing Load Models
##############################################################################################
###Selecting best fit model###############
app1.lr <- selBestModel("fMeHg", data = fMeHg_South,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at South")
print(app1.lr)
fMeHg_South_lr1 <- loadReg(fMeHg ~ model(1), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr1
fMeHg_South_lr2 <- loadReg(fMeHg ~ model(2), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr2
fMeHg_South_lr3 <- loadReg(fMeHg ~ model(3), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr3
fMeHg_South_lr4 <- loadReg(fMeHg ~ model(4), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr4
fMeHg_South_lr5 <- loadReg(fMeHg ~ model(5), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr5
fMeHg_South_lr6 <- loadReg(fMeHg ~ model(6), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr6
fMeHg_South_lr7 <- loadReg(fMeHg ~ model(7), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr7
fMeHg_South_lr8 <- loadReg(fMeHg ~ model(8), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr8
fMeHg_South_lr9 <- loadReg(fMeHg ~ model(9), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr9
fMeHg_South_lr1
fMeHg_South_lr2
fMeHg_South_lr3
fMeHg_South_lr4
fMeHg_South_lr5
fMeHg_South_lr5
fMeHg_South_lr6
fMeHg_South_lr6
fMeHg_South_lr7
fMeHg_South_lr8
fMeHg_South_lr9
fMeHg_South_lr3
fMeHg_South_lr3 <- loadReg(fMeHg ~ model(3), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at South")
setSweave("fMeHg_South_lr1_plot2",5,5)
plot(fMeHg_South_lr3,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("fMeHg_South_lr3_plot1",5,5)
plot(fMeHg_South_lr3,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("fMeHg_South_lr3_plot3",5,5)
plot(fMeHg_South_lr3,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("fMeHg_South_lr3_plot4",5,5)
plot(fMeHg_South_lr3,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("fMeHg_South_lr3_plot5",5,5)
plot(fMeHg_South_lr3,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr3 <- predConc(fMeHg_South_lr3, SouthQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr3
exportCSV(preds_conc_lr3, file.name = "South_fMeHg_conc_lr3_2010-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr3day<-predLoad(fMeHg_South_lr3,SouthQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr3day
exportCSV(preds_Flux_lr3day, file.name = "South_fMeHgFlux_lr3_Day2010-2019.cvs")
preds_Flux_lr3WY<-predLoad(fMeHg_South_lr3,SouthQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr3WY
exportCSV(preds_Flux_lr3WY, file.name = "South_fMeHg_Flux_lr3_WY2010-2019.cvs")
library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at South
##############################################################################################
# Interpolation data:South fMeHg data grab sample observations
fMeHg_South <- importRDB("South_fMeHg_2010-2019.txt")
fMeHg_South
### Reading in Flow Data
SouthQ <- importRDB("SouthQDaily_2010_2019.txt")
SouthQ$Dates <- with(SouthQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
SouthQ
app1.lr <- selBestModel("fMeHg", data = fMeHg_South,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at South")
print(app1.lr)
fMeHg_South_lr1 <- loadReg(fMeHg ~ model(1), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr1
fMeHg_South_lr2 <- loadReg(fMeHg ~ model(2), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr2
fMeHg_South_lr3 <- loadReg(fMeHg ~ model(3), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr3
fMeHg_South_lr4 <- loadReg(fMeHg ~ model(4), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr4
fMeHg_South_lr5 <- loadReg(fMeHg ~ model(5), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr5
fMeHg_South_lr6 <- loadReg(fMeHg ~ model(6), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr6
fMeHg_South_lr7 <- loadReg(fMeHg ~ model(7), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr7
fMeHg_South_lr8 <- loadReg(fMeHg ~ model(8), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr8
fMeHg_South_lr9 <- loadReg(fMeHg ~ model(9), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at South")
fMeHg_South_lr9
fMeHg_South_lr1
fMeHg_South_lr2
fMeHg_South_lr3
fMeHg_South_lr4
fMeHg_South_lr5
fMeHg_South_lr6
fMeHg_South_lr7
fMeHg_South_lr6
fMeHg_South_lr8
fMeHg_South_lr5 <- loadReg(fMeHg ~ model(5), data=fMeHg_South,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at South")
setSweave("fMeHg_South_lr1_plot2",5,5)
plot(fMeHg_South_lr5,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("fMeHg_South_lr5_plot1",5,5)
plot(fMeHg_South_lr5,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("fMeHg_South_lr5_plot3",5,5)
plot(fMeHg_South_lr5,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("fMeHg_South_lr5_plot4",5,5)
plot(fMeHg_South_lr5,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("fMeHg_South_lr5_plot5",5,5)
plot(fMeHg_South_lr5,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr5 <- predConc(fMeHg_South_lr5, SouthQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr5
exportCSV(preds_conc_lr5, file.name = "South_fMeHg_conc_lr5_2010-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr5day<-predLoad(fMeHg_South_lr5,SouthQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr5day
exportCSV(preds_Flux_lr5day, file.name = "South_fMeHgFlux_lr5_Day2010-2019.cvs")
preds_Flux_lr5WY<-predLoad(fMeHg_South_lr5,SouthQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr5WY
exportCSV(preds_Flux_lr5WY, file.name = "South_fMeHg_Flux_lr5_WY2010-2019.cvs")
