library(rloadest)
library(dataRetrieval)
library(ggplot2)
library(loadflex)
##############################################################################################
#Importing DATA for Cache Creek at Yolo
##############################################################################################
# Interpolation data:Yolo pMeHg data grab sample observations
pMeHg_Yolo <- importRDB("Yolo_pMeHg.txt")
pMeHg_Yolo
View(pMeHg_Yolo)
### Reading in Flow Data
YoloQ <- importRDB("YoloQDaily_2017_2019.txt")
YoloQ$Dates <- with(YoloQ, as.POSIXct(paste(Dates), format= "%Y-%m-%d"))
YoloQ
View(YoloQ)
app1.lr <- selBestModel("pMeHg", data = pMeHg_Yolo,
flow = "Flow", dates = "Dates", conc.units="ng/L",
station="Cache Creek at Yolo")
print(app1.lr)
pMeHg_Yolo_lr1 <- loadReg(pMeHg ~ model(1), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr1
pMeHg_Yolo_lr2 <- loadReg(pMeHg ~ model(2), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr2
pMeHg_Yolo_lr3 <- loadReg(pMeHg ~ model(3), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr3
pMeHg_Yolo_lr4 <- loadReg(pMeHg ~ model(4), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr4
pMeHg_Yolo_lr5 <- loadReg(pMeHg ~ model(5), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr5
pMeHg_Yolo_lr6 <- loadReg(pMeHg ~ model(6), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr6
pMeHg_Yolo_lr7 <- loadReg(pMeHg ~ model(7), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr7
pMeHg_Yolo_lr8 <- loadReg(pMeHg ~ model(8), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr8
pMeHg_Yolo_lr9 <- loadReg(pMeHg ~ model(9), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L",load.units="kg",
station="Cache Creek at Yolo")
pMeHg_Yolo_lr9
pMeHg_Yolo_lr1
pMeHg_Yolo_lr2
pMeHg_Yolo_lr3
pMeHg_Yolo_lr4
pMeHg_Yolo_lr5
pMeHg_Yolo_lr6
pMeHg_Yolo_lr7
pMeHg_Yolo_lr8
pMeHg_Yolo_lr9
pMeHg_Yolo_lr2 <- loadReg(pMeHg ~ model(2), data=pMeHg_Yolo,
flow="Flow", date="Dates", time.step="day",
flow.units="cfs", conc.units="ng/L", load.units="kg",
station="Cache Creek at Yolo")
setSweave("pMeHg_Yolo_lr2_plot2",5,5)
plot(pMeHg_Yolo_lr2,which=1,set.up=FALSE) #plot 1: Calibrated regression model
graphics.off()
setSweave("pMeHg_Yolo_lr2_plot1",5,5)
plot(pMeHg_Yolo_lr2,which=2,set.up=FALSE) #plot 2:Estimates of log load versus model residuals from AMLE regression
graphics.off()
setSweave("pMeHg_Yolo_lr2_plot3",5,5)
plot(pMeHg_Yolo_lr2,which=3,set.up=FALSE)# plot 3: Estimates of log load versus squared model residuals
graphics.off()
setSweave("pMeHg_Yolo_lr2_plot4",5,5)
plot(pMeHg_Yolo_lr2,which=4,set.up=FALSE) # plot 4: Standardized Serial Correlation
graphics.off()
setSweave("pMeHg_Yolo_lr2_plot5",5,5)
plot(pMeHg_Yolo_lr2,which=5,set.up=FALSE) # plot 5: Normal probability plot for the model residuals (Quantile plot)
graphics.off()
#############################################################################################
#predict concntrations
###############################################################################################
preds_conc_lr2 <- predConc(pMeHg_Yolo_lr2, YoloQ, by= "day", allow.incomplete= TRUE )
preds_conc_lr2
exportCSV(preds_conc_lr2, file.name = "Yolo_pMeHg_conc_lr2_2017-2019.cvs")
###############################################################################################
##We plot the estimated unite conc Vs the obsereved unite conc in xls
###############################################################################################
###############################################################################################
#load calculations using selected model
###############################################################################################
preds_Flux_lr2day<-predLoad(pMeHg_Yolo_lr2,YoloQ,load.units="kg",by="day",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr2day
exportCSV(preds_Flux_lr2day, file.name = "Yolo_pMeHgFlux_lr2_Day2017-2019.cvs")
preds_Flux_lr2WY<-predLoad(pMeHg_Yolo_lr2,YoloQ,load.units="kg",by="water year",allow.incomplete = TRUE,conf.int = 0.95,print = TRUE)
preds_Flux_lr2WY
exportCSV(preds_Flux_lr2WY, file.name = "Yolo_pMeHg_Flux_lr2_WY2017-2019.cvs")
load("~/Documents/Documents20/Alpers-CCSB/Rloadest_UnitFlowForCalibration/1_Yolo/pMeHg/.RData")
library(rloadest)
library(smwrStats)
install.packages('smwrStats')
library(smwrStats)
library(dataRetrieval)
library(ggplot2)
library(rloadest)
library(EGRET, lib.loc = "/Library/Frameworks/R.framework/Versions/4.0/Resources/library")
install.packages('smwrStats')
library(smwrStats)
library(stats4, lib.loc = "/Library/Frameworks/R.framework/Versions/4.0/Resources/library")
library(shiny)
